(self.webpackChunk_jupyrdf_jupyter_elk=self.webpackChunk_jupyrdf_jupyter_elk||[]).push([[73],{5619:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ELKLayoutModel:()=>m,ELKTextSizerModel:()=>u,ELKTextSizerView:()=>d});var n=r(6168),o=r(8081);function s(){return new Worker(r.p+"elk-worker.59076248689cda27bbe6.worker.js")}var i=r(4005),a=r.n(i),l=r(8036);class u extends o.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:u.model_name,_model_module_version:l.q4,_view_module:l.A1,_view_name:d.view_name,_view_module_version:l.q4,id:String(Math.random())})}initialize(e,t){super.initialize(e,t),l.ZF&&console.warn("ELK Test Sizer Init"),this.on("msg:custom",this.measure,this),window.sizer=this,l.ZF&&console.warn("ELK Text Done Init")}make_container(){const e=document.createElement("div"),t=this.get("_dom_classes").filter((e=>0===e.indexOf("styled-widget-")))[0];e.classList.add("p-Widget",l.gJ.widget_class,l.gJ.sizer_class,t);const r=this.get("namespaced_css");return e.innerHTML=`<div class="sprotty"><style>${r}</style><svg class="sprotty-graph"><g></g></svg></div>`,e}make_label(e){l.ZF&&console.warn("ELK Text Label for text",e);let t=c("text"),r=[l.gJ.label];return e.cssClasses.length>0&&(r=r.concat(e.cssClasses.split(" "))),t.classList.add(...r),t.textContent=e.value,l.ZF&&console.warn("ELK Text Label",t),t}measure(e){l.ZF&&console.warn("ELK Text Sizer Measure",e);const t=this.make_container(),r=t.getElementsByTagName("g")[0],n=c("g");e.texts.forEach((e=>{n.appendChild(this.make_label(e))})),r.appendChild(n),l.ZF&&console.warn("ELK Text Sizer to add node",n),l.ZF&&console.warn("ELK Text Sizer node",r),document.body.prepend(t);let o=Array.from(n.getElementsByTagName("text"));l.ZF&&console.warn("Sized Text"),window.requestAnimationFrame((()=>{const r={event:"measurement",measurements:this.read_sizes(e.texts,o)};l.ZF||document.body.removeChild(t),this.send(r,{},[])}))}read_sizes(e,t){let r=[],n=0;for(let o of t){l.ZF&&console.warn(o.innerHTML);const t=e[n],s=o.getBoundingClientRect();let i={id:t.id,width:s.width,height:s.height};r.push(i),n++}return l.ZF&&console.warn("Measurements",r),r}}u.model_name="ELKTextSizerModel";class d extends o.DOMWidgetView{async render(){}}function c(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}d.view_name="ELKTextSizerView";const p=new(a())({workerFactory:()=>(l.ZF&&console.warn("ELK Worker created"),new s)});class m extends o.DOMWidgetModel{constructor(){super(...arguments),this.layoutUpdated=new n.Signal(this)}defaults(){return Object.assign(Object.assign({},super.defaults()),{_view_module:l.A1,_model_name:m.model_name,_model_module_version:l.q4})}initialize(e,t){super.initialize(e,t),this.on("msg:custom",this.layoutRequest,this)}ensureElk(){null==this._elk&&(this._elk=p)}async layoutRequest(e){let t={id:e.id,event:"layout",payload:await this.layout(e.payload)};this.send(t,{},[])}async layout(e){let t=function(e){let t=new Map;return function e(r){t[r.id]=r.properties,delete r.properties,r.children&&r.children.map(e),r.ports&&r.ports.map(e),r.labels&&r.labels.map(e),r.edges&&r.edges.map(e)}(e),t}(e);this.ensureElk();let r=await this._elk.layout(e);var n;return n=t,function e(t){t.properties=n[t.id],t.children&&t.children.map(e),t.ports&&t.ports.map(e),t.labels&&t.labels.map(e),t.edges&&t.edges.map(e)}(r),r}}m.model_name="ELKLayoutModel"},4005:e=>{e.exports=function e(t,r,n){function o(i,a){if(!r[i]){if(!t[i]){if(s)return s(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[i]={exports:{}};t[i][0].call(u.exports,(function(e){return o(t[i][1][e]||e)}),u,u.exports,e,t,r,n)}return r[i].exports}for(var s=void 0,i=0;i<n.length;i++)o(n[i]);return o}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.defaultLayoutOptions,s=void 0===n?{}:n,a=r.algorithms,l=void 0===a?["layered","stress","mrtree","radial","force","disco","sporeOverlap","sporeCompaction","rectpacking"]:a,u=r.workerFactory,d=r.workerUrl;if(o(this,e),this.defaultLayoutOptions=s,this.initialized=!1,void 0===d&&void 0===u)throw new Error("Cannot construct an ELK without both 'workerUrl' and 'workerFactory'.");var c=u;void 0!==d&&void 0===u&&(c=function(e){return new Worker(e)});var p=c(d);if("function"!=typeof p.postMessage)throw new TypeError("Created worker does not provide the required 'postMessage' function.");this.worker=new i(p),this.worker.postMessage({cmd:"register",algorithms:l}).then((function(e){return t.initialized=!0})).catch(console.err)}return n(e,[{key:"layout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.layoutOptions,n=void 0===r?this.defaultLayoutOptions:r,o=t.logging,s=void 0!==o&&o,i=t.measureExecutionTime,a=void 0!==i&&i;return e?this.worker.postMessage({cmd:"layout",graph:e,layoutOptions:n,options:{logging:s,measureExecutionTime:a}}):Promise.reject(new Error("Missing mandatory parameter 'graph'."))}},{key:"knownLayoutAlgorithms",value:function(){return this.worker.postMessage({cmd:"algorithms"})}},{key:"knownLayoutOptions",value:function(){return this.worker.postMessage({cmd:"options"})}},{key:"knownLayoutCategories",value:function(){return this.worker.postMessage({cmd:"categories"})}},{key:"terminateWorker",value:function(){this.worker.terminate()}}]),e}();r.default=s;var i=function(){function e(t){var r=this;if(o(this,e),void 0===t)throw new Error("Missing mandatory parameter 'worker'.");this.resolvers={},this.worker=t,this.worker.onmessage=function(e){setTimeout((function(){r.receive(r,e)}),0)}}return n(e,[{key:"postMessage",value:function(e){var t=this.id||0;this.id=t+1,e.id=t;var r=this;return new Promise((function(n,o){r.resolvers[t]=function(e,t){e?(r.convertGwtStyleError(e),o(e)):n(t)},r.worker.postMessage(e)}))}},{key:"receive",value:function(e,t){var r=t.data,n=e.resolvers[r.id];n&&(delete e.resolvers[r.id],r.error?n(r.error):n(null,r.data))}},{key:"terminate",value:function(){this.worker.terminate&&this.worker.terminate()}},{key:"convertGwtStyleError",value:function(e){if(e){var t=e.__java$exception;t&&(t.cause&&t.cause.backingJsObject&&(e.cause=t.cause.backingJsObject,this.convertGwtStyleError(e.cause)),delete e.__java$exception)}}}]),e}()},{}],2:[function(e,t,r){"use strict";var n=e("./elk-api.js").default;Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports=n,n.default=n},{"./elk-api.js":1}]},{},[2])(2)}}]);